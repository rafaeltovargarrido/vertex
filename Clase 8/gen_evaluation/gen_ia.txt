prompt,reference,context
"Actúa como un experto SRE (Site Reliability Engineer). Te proporcionaré un log de error crudo de una aplicación, y tu tarea es convertirlo en un reporte de incidente estructurado y accionable.

Instrucciones:
* Extrae el error principal y el servicio afectado.
* Categoriza la gravedad del error en: [BAJA, MEDIA, ALTA, CRÍTICA].
* Crea una sección llamada ""Causa Raíz Probable"" explicando brevemente qué falló técnicamente.
* Crea una sección llamada ""Pasos de Mitigación"" con 2 o 3 acciones técnicas concretas para solucionar el problema.
* No incluyas el stack trace completo en la salida, solo la información relevante.
* Formatea la salida como una lista limpia con viñetas.

Log del Incidente:
Timestamp: 2023-11-28 14:05:00 UTC
Service: PaymentGateway-v2
Level: ERROR
Message: ConnectionRefusedError: [Errno 111] Connection refused connecting to database-prod-primary:5432. Retrying 3/5...
Context: Transaction ID tx-998877 failed during checkout flow. Upstream dependency 'database-prod-primary' is unreachable. Timeout after 30000ms.","Reporte de Incidente:

* **Servicio Afectado:** PaymentGateway-v2
* **Error Principal:** ConnectionRefusedError (Conexión rechazada a la base de datos)
* **Gravedad:** CRÍTICA (Afecta al flujo de pago/checkout)

Causa Raíz Probable:
* La base de datos principal (database-prod-primary) está caída, reiniciándose o hay un bloqueo de red en el puerto 5432 que impide la conexión del servicio de pagos.

Pasos de Mitigación:
* Verificar el estado del servicio 'database-prod-primary' y reiniciarlo si está detenido.
* Comprobar las reglas de firewall o Security Groups para asegurar que el puerto 5432 está abierto para el PaymentGateway.
* Escalar a la réplica de lectura si la base de datos principal tiene un fallo de hardware irrecuperable inmediato.","Entorno: Producción. Base de datos: PostgreSQL. El servicio de pagos es crítico para el negocio."
"Actúa como un analista de operaciones de Nivel 2. Te proporcionaré una alerta técnica de Prometheus, y tu tarea es explicarla en lenguaje natural para un gestor de proyecto no técnico.

Instrucciones:
* Analiza la métrica y el umbral que ha saltado.
* Explica qué significa esta alerta en términos de impacto al usuario final (¿va lento? ¿está caído?).
* Ignora los tecnicismos de etiquetas de Kubernetes (pod_id, namespace) a menos que sean vitales.
* Termina con una recomendación de si se debe despertar al equipo de guardia o puede esperar a mañana.
* Formatea la salida como un breve párrafo explicativo seguido de la recomendación en negrita.

Alerta Técnica:
Alertname: HighLatencyP99
Expression: histogram_quantile(0.99, rate(http_request_duration_seconds_bucket[5m])) > 2.5
Labels: {service=""frontend-web"", env=""prod"", region=""europe-west1""}
Value: 4.82s
Threshold: 2.5s
Duration: 15m","El servicio web principal (frontend) está respondiendo muy lentamente a los usuarios en Europa. Específicamente, el 99% de las peticiones están tardando casi 5 segundos en cargar, lo cual es el doble de nuestro límite aceptable de 2.5 segundos. Esto significa que los clientes están experimentando una web muy lenta y es probable que abandonen la página.

**Recomendación: Despertar al equipo de guardia inmediatamente (Impacto alto en experiencia de usuario durante 15 min).**","SLA de Latencia: 2.5 segundos. Región afectada: Europa."
"Actúa como un analista de ciberseguridad. Te proporcionaré un fragmento de log de acceso web. Tu tarea es analizarlo en busca de intentos de ataque y generar una alerta de seguridad.

Instrucciones:
* Identifica si hay algún patrón sospechoso en la URL o el User-Agent.
* Clasifica el tipo de ataque (ej: SQL Injection, XSS, Fuerza Bruta, Escaneo).
* Extrae la dirección IP del atacante.
* Si el log parece tráfico normal, responde simplemente con ""Tráfico Legítimo"".
* Formato de salida: JSON con las claves ""tipo_ataque"", ""ip_origen"", ""nivel_riesgo"".

Log Web:
192.168.1.55 - - [12/Nov/2023:10:00:00 +0000] ""GET /login?user=admin' OR '1'='1 HTTP/1.1"" 200 4520 ""-"" ""Mozilla/5.0 sqlmap/1.4.7""","{
  ""tipo_ataque"": ""SQL Injection"",
  ""ip_origen"": ""192.168.1.55"",
  ""nivel_riesgo"": ""ALTO""
}","Log de servidor Apache. El parámetro 'user' no debería contener comillas ni lógica booleana."